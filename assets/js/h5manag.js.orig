<<<<<<< HEAD
// Generated by CoffeeScript 1.7.1
=======
// Generated by CoffeeScript 1.6.3
>>>>>>> 7a4e85f5678c96b54a83f2a7010711678863ab4e
(function() {
  var drawTable, i, properties, rest, _ref;

  H5.Data.restURL = "http://" + document.domain + "/siema/rest";

  H5.DB.ocorrencia = {};

  H5.DB.ocorrencia.table = "ocorrencia";

  H5.DB.ocorrencia.data = {
    init: function() {
      return this.ocorrencia = {};
    },
    populate: function(nro_ocorrencia, des_ocorrencia, legado) {
      var self;
      self = this.ocorrencia;
      self[nro_ocorrencia] = {};
      self[nro_ocorrencia].nro_ocorrencia = nro_ocorrencia;
      self[nro_ocorrencia].des_ocorrencia = des_ocorrencia;
      return self[nro_ocorrencia].legado = legado;
    }
  };

  rest = new H5.Rest({
    url: H5.Data.restURL,
    table: H5.DB.ocorrencia.table,
    fields: "nro_ocorrencia, des_ocorrencia, legado"
  });

  H5.DB.ocorrencia.data.init();

  _ref = rest.data;
  for (i in _ref) {
    properties = _ref[i];
    H5.DB.ocorrencia.data.populate(properties.nro_ocorrencia, properties.des_ocorrencia, properties.legado);
  }

  $("#btn_manage1").addClass("active");

  $(".nav-sidebar a").on("click", function(event) {
    $(this).each(function() {
      return $(".nav-sidebar a").parent().removeClass("active");
    });
    $(this).parent().addClass("active");
    if ($(this).prop("id") === "btn-manage1") {
      $("#manage1").show();
      $("#manage2").hide();
      $("#manage3").hide();
      return $("#manage4").hide();
    } else if ($(this).prop("id") === "btn-manage2") {
      $("#manage1").hide();
      $("#manage2").show();
      $("#manage3").hide();
      return $("#manage4").hide();
    } else if ($(this).prop("id") === "btn-manage3") {
      $("#manage1").hide();
      $("#manage2").hide();
      $("#manage3").show();
      return $("#manage4").hide();
    } else if ($(this).prop("id") === "btn-manage4") {
      $("#manage1").hide();
      $("#manage2").hide();
      $("#manage3").hide();
      return $("#manage4").show();
    }
  });

  drawTable = function() {
    var html, key, reg, _ref1;
    html = '';
    html = '<table class="table table-striped">';
    html += '  <thead>';
    html += '    <tr>';
    html += '      <th>ID da Ocorrência</th>';
    html += '      <th>Descrição da Ocorrência</th>';
    html += '      <th>Editar</th>';
    html += '    </tr>';
    html += '  </thead>';
    html += '  <tbody>';
    _ref1 = H5.DB.ocorrencia.data.ocorrencia;
    for (key in _ref1) {
      reg = _ref1[key];
      if (!reg.legado) {
        html += '    <tr>';
        html += '      <td>' + reg.nro_ocorrencia + '</td>';
        html += '      <td>' + reg.des_ocorrencia + '</td>';
        html += '      <td><a data-toggle="modal" class="editOcorrencia" data-ocorrencia="' + reg.nro_ocorrencia + '"href="#editMeModal"><i class="icon-edit icon-white"></i></a></td>';
        html += '    </tr>';
      }
    }
    html += '  </tbody>';
    html += '</table>';
    return $("#table-ocorrencia").html(html);
  };

  drawTable();

  $('#editMeModal').modal({
    keyboard: false,
    backdrop: false,
    show: false
  });

  $("#editMeModal").draggable({
    handle: ".modal-header"
  });

  $("a.editOcorrencia").on("click", function(event) {
    var nro_ocorrencia;
    nro_ocorrencia = $(this).attr("data-ocorrencia");
    $("#nro_ocorrencia").val(nro_ocorrencia);
    return $("#formLoadEdit").submit();
  });

  $("#manag").hide();

}).call(this);
